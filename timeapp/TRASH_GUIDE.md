# 回收站功能使用指南

## 快速开始

### 访问应用
1. 打开浏览器，访问 http://localhost:5173
2. 登录或注册账户

### 删除任务

#### 步骤：
1. 在"任务管理"页面找到要删除的任务
2. 点击任务卡片右侧的"删除"按钮（红色）
3. 确认对话框将显示：`"确定要删除此任务吗？已删除的任务可在回收站找到。"`
4. 点击"确定"确认删除
5. 任务将从任务列表中消失，但数据被保留在回收站

#### 对话框说明：
- **确定**：确认删除，任务移到回收站
- **取消**：放弃删除，任务保留在任务列表中

### 访问回收站

#### 方式 1 - 使用侧边栏导航
1. 在左侧导航栏中点击"回收站"

#### 方式 2 - 从任务页面直接跳转
1. 在任务管理页面顶部右侧，点击"🗑️ 回收站"按钮

### 恢复已删除的任务

#### 步骤：
1. 进入回收站页面
2. 找到要恢复的任务
3. 点击任务右侧的"恢复"按钮（绿色）
4. 确认对话框将显示：`"确定要恢复此任务吗？"`
5. 点击"确定"确认恢复
6. 任务将回到活跃任务列表

#### 恢复后：
- 任务恢复到原来的状态（标题、描述、分类、截止日期等）
- 任务状态保持删除前的状态

### 永久删除任务

#### 步骤：
1. 进入回收站页面
2. 找到要永久删除的任务
3. 点击任务右侧的"永久删除"按钮（深红色）
4. 强确认对话框将显示：`"确定要永久删除此任务吗？此操作无法撤销。"`
5. 点击"确定"确认永久删除
6. 任务将被完全删除，**无法恢复**

⚠️ **警告**：永久删除是不可逆的操作！

## 回收站页面说明

### 页面布局

```
[← 返回任务] 回收站
━━━━━━━━━━━━━━━━━━━━━━━
共有 X 个已删除的任务

┌─────────────────────────────────┐
│ ~~已删除的任务标题~~              │
│ 📝 任务描述                      │
│ 📁 分类: xxx  📅 截止: xxxx-xx-xx │
│ 🗑️ 删除于: xxxx-xx-xx           │
│                                 │
│              [恢复] [永久删除]    │
└─────────────────────────────────┘
```

### 页面元素说明

| 元素 | 说明 |
|------|------|
| 任务标题 | 显示为删除线样式（~~标题~~），表示已删除 |
| 📁 分类 | 任务的原始分类 |
| 📅 截止 | 任务的原始截止日期 |
| 🗑️ 删除于 | 任务被删除的日期和时间 |
| 恢复按钮 | 绿色按钮，点击恢复任务 |
| 永久删除按钮 | 深红色按钮，永久删除任务 |
| ← 返回任务 | 返回到任务管理页面 |

## 使用场景

### 场景 1：误删了任务
1. 立即进入回收站
2. 找到误删的任务
3. 点击"恢复"按钮
4. 任务恢复到活跃列表

### 场景 2：清理回收站
1. 进入回收站页面
2. 查看已删除但不需要的任务
3. 对于不需要的任务，点击"永久删除"
4. 确认永久删除

### 场景 3：检查历史删除
1. 进入回收站
2. 查看所有已删除任务的标题和删除时间
3. 决定是恢复还是永久删除

## 常见问题

### Q: 删除任务后能在哪里找到？
A: 在侧边栏的"回收站"中。页面顶部也有"🗑️ 回收站"快速链接。

### Q: 如何永久删除任务？
A: 
1. 进入回收站
2. 找到要永久删除的任务
3. 点击"永久删除"按钮
4. 确认操作（此操作无法撤销）

### Q: 永久删除的任务能恢复吗？
A: 不能。永久删除是不可逆的操作。如果有疑虑，请先点击"恢复"按钮将任务恢复到活跃列表。

### Q: 回收站中的任务是否占用存储空间？
A: 是的，回收站中的任务仍然占用服务器存储空间。如果需要释放空间，请永久删除不需要的任务。

### Q: 为什么需要删除确认？
A: 为了防止误删。确认步骤给用户改变主意的机会。

### Q: 删除的数据会备份吗？
A: 不会。应用不自动备份已删除的任务。如果需要备份，请在永久删除前导出数据。

## 技术细节

### 数据结构
当任务被删除时，会添加以下字段：
- `isDeleted: true` - 标记为已删除
- `deletedAt: "2024-12-27T10:30:00.000Z"` - 删除时间戳

### API 端点

| 操作 | 方法 | 端点 | 说明 |
|------|------|------|------|
| 获取活跃任务 | GET | `/api/tasks` | 不包括已删除的任务 |
| 获取回收站 | GET | `/api/trash` | 仅已删除的任务 |
| 删除任务 | DELETE | `/api/tasks/:taskId` | 软删除（可恢复） |
| 恢复任务 | PUT | `/api/tasks/:taskId/restore` | 从回收站恢复 |
| 永久删除 | DELETE | `/api/trash/:taskId` | 完全删除（不可恢复） |

### 数据持久化
- 所有任务数据保存在 `data/tasks.json` 文件中
- 已删除的任务保留在同一文件中，仅标记 `isDeleted`
- 用户数据通过 `userId` 字段完全隔离

## 安全性考虑

✅ 已实现的安全措施：
- 所有删除操作需要用户确认
- 用户只能看到自己的任务和回收站
- 永久删除需要明确的二次确认
- 后端验证用户权限（确保用户只能删除自己的任务）

## 反馈和建议

如果您有关于回收站功能的建议或发现问题，请：
1. 检查浏览器控制台是否有错误信息
2. 验证网络连接是否正常
3. 尝试刷新页面
4. 如果问题仍然存在，请检查服务器日志

---

**版本信息**：回收站功能 v1.0  
**最后更新**：2024-12-27
